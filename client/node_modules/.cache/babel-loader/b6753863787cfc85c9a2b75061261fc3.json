{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\dilji\\\\capstone\\\\sync\\\\Capstone-project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\dilji\\\\capstone\\\\sync\\\\Capstone-project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\dilji\\\\capstone\\\\sync\\\\Capstone-project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\dilji\\\\capstone\\\\sync\\\\Capstone-project\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import ReactDOM from'react-dom';import{connect}from'react-redux';import*as actions from'../actions/index';import{Link}from'react-router-dom';import{Redirect}from\"react-router-dom\";import StripeCheckout from'react-stripe-checkout';import{STRIPE_PS_KEY}from'../config/keys';import axios from'axios';var Cart=/*#__PURE__*/function(_Component){_inherits(Cart,_Component);var _super=_createSuper(Cart);function Cart(props){var _this;_classCallCheck(this,Cart);_this=_super.call(this,props);_this.makePayment=function(token){var items=_this.props.items;var payableAmt=_this.props.total;var user=_this.props.userProfile;var body={token:token,items:items,payableAmt:payableAmt,user:user};axios.post('users/payment',body).then(function(response){_this.props.emptyCart();_this.setState({paySuccess:true});}).catch(function(err){_this.setState({payFailure:true});});};_this.handleIncrease=function(id,quantity){if(quantity!=='99'){_this.props.incrementQuantity(id);}else{// books out of stock\n}};_this.handleDecrease=function(id,quantity){if(quantity==='1'){_this.handleRemove(id);}else{_this.props.decrementQuantity(id);}};_this.handleRemove=function(id){_this.props.removeFromCart(id);};_this.handleCupoun=function(e){//call backend any check if coupon is valid\n};_this.handleCupounSubmit=function(e){e.preventDefault();ReactDOM.findDOMNode(_this.refs.couponMsg).style.display='block';};_this.state={paySuccess:false,payFailure:false};return _this;}_createClass(Cart,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,items=_this$props.items,subTotal=_this$props.subTotal,shipping=_this$props.shipping,total=_this$props.total;if(this.state.paySuccess){return/*#__PURE__*/React.createElement(Redirect,{to:\"/payment_success\"});}if(this.state.payFailure){return/*#__PURE__*/React.createElement(Redirect,{to:\"/payment_failure\"});}return/*#__PURE__*/React.createElement(\"div\",{style:{background:'#eecda3'}},/*#__PURE__*/React.createElement(\"div\",{className:\"px-4 px-lg-0\",id:\"background\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pb-5 pt-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-12 p-5 bg-white rounded shadow-sm mb-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"border-0\",id:\"title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-2 px-3 text-uppercase\"},\"Book\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"border-0 \",id:\"title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-2 text-uppercase text-center\"},\"Price\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"border-0 \",id:\"title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-2 text-uppercase text-center\"},\"Quantity\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"border-0 \",id:\"title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-2 text-uppercase text-center\"},\"Remove\")))),/*#__PURE__*/React.createElement(\"tbody\",null,items.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"th\",{scope:\"row\",className:\"border-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},item.book.image?/*#__PURE__*/React.createElement(\"img\",{src:require(\"../images/books_DB/\".concat(item.book.image)),alt:\"book_image\",width:\"70\",className:\"img-fluid rounded shadow-sm\"}):/*#__PURE__*/React.createElement(\"img\",{src:require(\"../images/books_DB/no_cover.jpg\"),alt:\"book_image\",width:\"70\",className:\"img-fluid rounded shadow-sm\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"ml-3 d-inline-block align-middle\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-0\"},\" \",/*#__PURE__*/React.createElement(Link,{to:'book/'+item.book.id,className:\"text-dark d-inline-block align-middle text-truncate\"},item.book.name)),/*#__PURE__*/React.createElement(\"span\",{className:\"text-muted font-weight-normal font-italic d-block\"},item.book.author)))),/*#__PURE__*/React.createElement(\"td\",{className:\"border-0 align-middle text-center\"},/*#__PURE__*/React.createElement(\"strong\",null,\"$ \",item.book.price)),/*#__PURE__*/React.createElement(\"td\",{className:\"border-0 align-middle text-center\"},/*#__PURE__*/React.createElement(\"strong\",null,/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.handleIncrease(\"\".concat(item.book.id),\"\".concat(item.quantity));},id:\"arrow\",className:\"btn btn-primary btn-sm mr-3\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-arrow-up \"})),item.quantity,/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.handleDecrease(\"\".concat(item.book.id),\"\".concat(item.quantity));},id:\"arrow\",className:\"btn btn-primary btn-sm ml-3\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-arrow-down \"})))),/*#__PURE__*/React.createElement(\"td\",{className:\"border-0 align-middle text-center\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.handleRemove(\"\".concat(item.book.id));},className:\"btn btn-danger btn-sm \"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-trash \"}))));})))))),/*#__PURE__*/React.createElement(\"div\",{className:\"row py-5 p-4 bg-white rounded shadow-sm\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{id:\"title\",className:\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\"},\"Coupon code\"),/*#__PURE__*/React.createElement(\"div\",{className:\"p-4\"},/*#__PURE__*/React.createElement(\"p\",{className:\"font-italic mb-4\"},\"If you have a coupon code, please enter it in the box below\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-4 border rounded-pill p-2\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Apply coupon\",onChange:this.handleCupoun,\"aria-describedby\":\"button-addon3\",className:\"form-control border-0\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append border-0\"},/*#__PURE__*/React.createElement(\"button\",{id:\"button-addon3\",type:\"button\",onClick:this.handleCupounSubmit,className:\"btn btn-danger px-4 rounded-pill\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-gift mr-2\"}),\"Apply coupon\"))),/*#__PURE__*/React.createElement(\"div\",{style:couponMsg,ref:\"couponMsg\"},\"Invalid Coupon\")),/*#__PURE__*/React.createElement(\"div\",{id:\"title\",className:\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\"},\"Instructions for seller\"),/*#__PURE__*/React.createElement(\"div\",{className:\"p-4\"},/*#__PURE__*/React.createElement(\"p\",{className:\"font-italic mb-4\"},\"If you have some information for the seller you can leave them in the box below\"),/*#__PURE__*/React.createElement(\"textarea\",{onChange:this.handleSellerInstructions,name:\"\",cols:\"30\",rows:\"2\",className:\"form-control\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{id:\"title\",className:\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\"},\"Order summary \"),/*#__PURE__*/React.createElement(\"div\",{className:\"p-4\"},/*#__PURE__*/React.createElement(\"p\",{className:\"font-italic mb-4\"},\"Shipping and additional costs are calculated based on values you have entered.\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-unstyled mb-4\"},/*#__PURE__*/React.createElement(\"li\",{className:\"d-flex justify-content-between py-3 border-bottom\"},/*#__PURE__*/React.createElement(\"strong\",{className:\"text-muted\"},\"Order Subtotal \"),/*#__PURE__*/React.createElement(\"strong\",null,\"$ \",subTotal)),/*#__PURE__*/React.createElement(\"li\",{className:\"d-flex justify-content-between py-3 border-bottom\"},/*#__PURE__*/React.createElement(\"strong\",{className:\"text-muted\"},\"Shipping and handling\"),/*#__PURE__*/React.createElement(\"strong\",null,\"$ \",total?shipping:0)),/*#__PURE__*/React.createElement(\"li\",{className:\"d-flex justify-content-between py-3 border-bottom\"},/*#__PURE__*/React.createElement(\"strong\",{className:\"text-muted\"},\"Tax\"),/*#__PURE__*/React.createElement(\"strong\",null,\"$ 0\")),/*#__PURE__*/React.createElement(\"li\",{className:\"d-flex justify-content-between py-3 border-bottom\"},/*#__PURE__*/React.createElement(\"strong\",{className:\"text-muted\"},\"Total\"),/*#__PURE__*/React.createElement(\"h5\",{className:\"font-weight-bold\"},\"$ \",total))),/*#__PURE__*/React.createElement(StripeCheckout,{stripeKey:STRIPE_PS_KEY,token:this.makePayment,name:\"Book Store\",currency:\"CAD\",billingAddress:true,amount:total*100},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-large btn-danger \"},\"Proceed to checkout\")))))))));}}]);return Cart;}(Component);var couponMsg={textAlign:'center',padding:'10px',background:'#28a745',color:'#fff',marginBottom:'10px',display:'none'};var mapStateToProps=function mapStateToProps(state){return{items:state.cart.items,subTotal:state.cart.subTotal,shipping:state.cart.shipping,total:state.cart.total,userProfile:state.profile.userProfile};};export default connect(mapStateToProps,actions)(Cart);","map":{"version":3,"sources":["C:/Users/dilji/capstone/sync/Capstone-project/client/src/components/Cart.js"],"names":["React","Component","ReactDOM","connect","actions","Link","Redirect","StripeCheckout","STRIPE_PS_KEY","axios","Cart","props","makePayment","token","items","payableAmt","total","user","userProfile","body","post","then","response","emptyCart","setState","paySuccess","catch","err","payFailure","handleIncrease","id","quantity","incrementQuantity","handleDecrease","handleRemove","decrementQuantity","removeFromCart","handleCupoun","e","handleCupounSubmit","preventDefault","findDOMNode","refs","couponMsg","style","display","state","subTotal","shipping","background","map","item","index","book","image","require","name","author","price","handleSellerInstructions","textAlign","padding","color","marginBottom","mapStateToProps","cart","profile"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux';\r\nimport * as actions from '../actions/index';\r\nimport { Link } from 'react-router-dom';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport StripeCheckout from 'react-stripe-checkout';\r\nimport { STRIPE_PS_KEY } from '../config/keys';\r\nimport axios from 'axios';\r\n\r\n\r\n\r\n\r\nclass Cart extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.state = {\r\n            paySuccess: false,\r\n            payFailure: false\r\n        }\r\n    }\r\n\r\n    makePayment = token => {\r\n        const items = this.props.items;\r\n        const payableAmt = this.props.total;\r\n        const user = this.props.userProfile;\r\n        const body = {\r\n            token,\r\n            items,\r\n            payableAmt,\r\n            user\r\n        }\r\n        axios.post('users/payment', body)\r\n            .then((response) => {\r\n                this.props.emptyCart();\r\n                this.setState({\r\n                    paySuccess: true\r\n                })\r\n            })\r\n            .catch((err) => {\r\n                this.setState({\r\n                    payFailure: true\r\n                })\r\n            })\r\n    }\r\n\r\n\r\n    handleIncrease = (id, quantity) => {\r\n        if (quantity !== '99') {\r\n            this.props.incrementQuantity(id);\r\n        } else {\r\n            // books out of stock\r\n        }\r\n\r\n    }\r\n\r\n    handleDecrease = (id, quantity) => {\r\n        if (quantity === '1') {\r\n            this.handleRemove(id);\r\n        } else {\r\n            this.props.decrementQuantity(id);\r\n        }\r\n\r\n    }\r\n\r\n    handleRemove = id => {\r\n        this.props.removeFromCart(id);\r\n    }\r\n\r\n    handleCupoun = e => {\r\n        //call backend any check if coupon is valid\r\n    }\r\n\r\n    handleCupounSubmit = e => {\r\n        e.preventDefault();\r\n        ReactDOM.findDOMNode(this.refs.couponMsg).style.display = 'block';\r\n    }\r\n    render() {\r\n        const { items, subTotal, shipping, total } = this.props;\r\n        if (this.state.paySuccess) {\r\n            return <Redirect to='/payment_success' />;\r\n        }\r\n        if (this.state.payFailure) {\r\n            return <Redirect to='/payment_failure' />;\r\n        }\r\n        return (\r\n            <div style={{ background: '#eecda3' }}>\r\n                <div className=\"px-4 px-lg-0\" id=\"background\">\r\n\r\n                    <div className=\"pb-5 pt-5\">\r\n                        <div className=\"container\" >\r\n                            <div className=\"row\">\r\n                                <div className=\"col-lg-12 p-5 bg-white rounded shadow-sm mb-5\">\r\n\r\n                                    <div className=\"table-responsive\">\r\n                                        <table className=\"table\">\r\n                                            <thead>\r\n                                                <tr>\r\n                                                    <th scope=\"col\" className=\"border-0\" id=\"title\">\r\n                                                        <div className=\"p-2 px-3 text-uppercase\" >Book</div>\r\n                                                    </th>\r\n                                                    <th scope=\"col\" className=\"border-0 \" id=\"title\">\r\n                                                        <div className=\"py-2 text-uppercase text-center\">Price</div>\r\n                                                    </th>\r\n                                                    <th scope=\"col\" className=\"border-0 \"id=\"title\">\r\n                                                        <div className=\"py-2 text-uppercase text-center\">Quantity</div>\r\n                                                    </th>\r\n                                                    <th scope=\"col\" className=\"border-0 \" id=\"title\">\r\n                                                        <div className=\"py-2 text-uppercase text-center\">Remove</div>\r\n                                                    </th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                {items.map((item, index) => {\r\n                                                    return (\r\n                                                        <tr key={index}>\r\n                                                            <th scope=\"row\" className=\"border-0\">\r\n                                                                <div className=\"p-2\">\r\n                                                                    {item.book.image ? <img src={require(`../images/books_DB/${item.book.image}`)} alt=\"book_image\" width=\"70\" className=\"img-fluid rounded shadow-sm\" /> : <img src={require(`../images/books_DB/no_cover.jpg`)} alt=\"book_image\" width=\"70\" className=\"img-fluid rounded shadow-sm\" />}\r\n\r\n                                                                    <div className=\"ml-3 d-inline-block align-middle\">\r\n                                                                        <h5 className=\"mb-0\"> <Link to={'book/' + item.book.id} className=\"text-dark d-inline-block align-middle text-truncate\">{item.book.name}</Link></h5><span className=\"text-muted font-weight-normal font-italic d-block\">{item.book.author}</span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </th>\r\n                                                            <td className=\"border-0 align-middle text-center\"><strong>$ {item.book.price}</strong></td>\r\n                                                            <td className=\"border-0 align-middle text-center\"><strong><button onClick={() => this.handleIncrease(`${item.book.id}`, `${item.quantity}`)} id=\"arrow\" className=\"btn btn-primary btn-sm mr-3\"><i className=\"fa fa-arrow-up \"></i></button>{item.quantity}<button onClick={() => this.handleDecrease(`${item.book.id}`, `${item.quantity}`)} id=\"arrow\" className=\"btn btn-primary btn-sm ml-3\"><i className=\"fa fa-arrow-down \" ></i></button></strong></td>\r\n                                                            <td className=\"border-0 align-middle text-center\"><button onClick={() => this.handleRemove(`${item.book.id}`)} className=\"btn btn-danger btn-sm \"><i className=\"fa fa-trash \"></i></button></td>\r\n                                                        </tr>\r\n                                                    )\r\n                                                })}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"row py-5 p-4 bg-white rounded shadow-sm\">\r\n                                <div className=\"col-lg-6\" >\r\n                                    <div id=\"title\" className=\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\">Coupon code</div>\r\n                                    <div className=\"p-4\">\r\n                                        <p className=\"font-italic mb-4\">If you have a coupon code, please enter it in the box below</p>\r\n                                        <div className=\"input-group mb-4 border rounded-pill p-2\">\r\n                                            <input type=\"text\" placeholder=\"Apply coupon\" onChange={this.handleCupoun} aria-describedby=\"button-addon3\" className=\"form-control border-0\" />\r\n                                            <div className=\"input-group-append border-0\">\r\n                                                <button id=\"button-addon3\" type=\"button\" onClick={this.handleCupounSubmit} className=\"btn btn-danger px-4 rounded-pill\"><i className=\"fa fa-gift mr-2\"></i>Apply coupon</button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div style={couponMsg} ref=\"couponMsg\">Invalid Coupon</div>\r\n                                    </div>\r\n                                    <div id=\"title\" className=\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\">Instructions for seller</div>\r\n                                    <div className=\"p-4\">\r\n                                        <p className=\"font-italic mb-4\">If you have some information for the seller you can leave them in the box below</p>\r\n                                        <textarea onChange={this.handleSellerInstructions} name=\"\" cols=\"30\" rows=\"2\" className=\"form-control\"></textarea>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"col-lg-6\">\r\n                                    <div id=\"title\" className=\" rounded-pill px-4 py-3 text-uppercase font-weight-bold\">Order summary </div>\r\n                                    <div className=\"p-4\">\r\n                                        <p className=\"font-italic mb-4\">Shipping and additional costs are calculated based on values you have entered.</p>\r\n                                        <ul className=\"list-unstyled mb-4\">\r\n                                            <li className=\"d-flex justify-content-between py-3 border-bottom\"><strong className=\"text-muted\">Order Subtotal </strong><strong>$ {subTotal}</strong></li>\r\n                                            <li className=\"d-flex justify-content-between py-3 border-bottom\"><strong className=\"text-muted\">Shipping and handling</strong><strong>$ {total ? shipping : 0}</strong></li>\r\n                                            <li className=\"d-flex justify-content-between py-3 border-bottom\"><strong className=\"text-muted\">Tax</strong><strong>$ 0</strong></li>\r\n                                            <li className=\"d-flex justify-content-between py-3 border-bottom\"><strong className=\"text-muted\">Total</strong>\r\n                                                <h5 className=\"font-weight-bold\">$ {total}</h5>\r\n                                            </li>\r\n                                        </ul>\r\n                                        {/* <Link to='/checkout' className=\"text-decoration-none\"><button className=\"btn btn-danger rounded-pill py-2 btn-block text-decoration-none\">Procceed to checkout</button></Link>\r\n                                         */}\r\n                                        <StripeCheckout\r\n                                            stripeKey={STRIPE_PS_KEY}\r\n                                            token={this.makePayment}\r\n                                            name=\"Book Store\"\r\n                                            currency=\"CAD\"\r\n                                            billingAddress={true}\r\n                                            amount={total * 100} >\r\n                                            <button className=\"btn btn-large btn-danger \">Proceed to checkout</button>\r\n                                        </StripeCheckout>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst couponMsg = {\r\n    textAlign: 'center',\r\n    padding: '10px',\r\n    background: '#28a745',\r\n    color: '#fff',\r\n    marginBottom: '10px',\r\n    display: 'none'\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        items: state.cart.items,\r\n        subTotal: state.cart.subTotal,\r\n        shipping: state.cart.shipping,\r\n        total: state.cart.total,\r\n        userProfile: state.profile.userProfile\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, actions)(Cart)\r\n"]},"metadata":{},"sourceType":"module"}